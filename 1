from pyspark.sql.functions import col
from pyspark.sql.types import DateType, StringType

def transform_to_silver(df):
    # Cast fields to proper data types
    date_fields = ["dateOfBirth", "effectiveDate", "terminationDate"]
    string_fields = ["familyType", "relationship"]

    for field in date_fields:
        df = df.withColumn(field, col(field).cast(DateType()))
    for field in string_fields:
        df = df.withColumn(field, col(field).cast(StringType()))

    # Drop rows with nulls in required fields
    required_columns = [
        "memberId", "groupId", "familyId", "firstName", "lastName",
        "relationship", "sexCode", "dateOfBirth", "socialSecurityNumber",
        "address1", "country", "familyType", "phoneNumber",
        "effectiveDate", "terminationDate", "plan"
    ]
    return 
